<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Accounts Hub UI</title>
<link rel="stylesheet" href="{{ root_path }}/static/styles.css">
</head>
<body>

<h2>Remote Linux User Management</h2>

<form id="userForm">
    <label>SSH Username:</label>
    <input type="text" name="ssh_user" required>

    <label>SSH Password:</label>
    <input type="password" name="ssh_password" required>

    <label>Target User:</label>
    <input type="text" name="target_user" required>

    <label>Action:</label>
    <select name="action">
        <option value="add">Add</option>
        <option value="delete">Delete</option>
        <option value="reset">Reset Password</option>
        <option value="unlock">Unlock</option>
    </select>

    <label>New Password (for reset only):</label>
    <input type="text" name="new_password">

    <label>Servers (one per line):</label>
    <textarea name="servers" rows="5" cols="30"></textarea>

    <button type="submit">Submit</button>
</form>

<pre id="output"></pre>

<script>
const form = document.getElementById('userForm');
const output = document.getElementById('output');

form.addEventListener('submit', (e) => {
    e.preventDefault();
    output.textContent = "";
 
    const ws = new WebSocket(`ws://${location.host}{{ root_path }}/ws`); 
    ws.onopen = () => {
        const data = Object.fromEntries(new FormData(form).entries());
        ws.send(JSON.stringify(data));
    };

    ws.onmessage = (event) => {
        output.textContent += event.data + "\n";
    };

    ws.onclose = () => output.textContent += "\nConnection closed.";
});
</script>

</body>
</html>

